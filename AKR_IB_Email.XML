<?xml version="1.0" encoding="utf-8"?>
<ScriptContainer xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" noNamespaceSchemaLocation="http://lab-iniws01/scriptcontainer.xsd" BusNo="4597359" UserID="7141209">
  <Actions>
    <ActionStruct>
      <ActionID>95</ActionID>
      <Action>SNIPPET</Action>
      <Caption>PassToIA</Caption>
      <Parameters>
        <string>IF test
{
    //Body = "where is my shipment? I am so upset that it is not here yet!! I would like to speak with a supervisor, please have them contact me."
    PatronEntries = "where is my shipment? I am so upset that it is not here yet!! I would like to speak with a supervisor, please have them contact me. ShowAnalytics Email Confidentiality Notice: The information contained IN this transmission is confidential, proprietary or privileged and may be subject TO protection under the law. The message is intended FOR the sole use of the individual or entity TO whom it is addressed. IF you are not the intended recipient, you are notified that any use, distribution or copying of the message is strictly prohibited and may subject you TO criminal or civil penalties. IF you received this transmission IN error, please contact the sender immediately by replying TO this email and delete the material FROM any computer.   Ã‚Â­Ã‚Â­  "
}

//set the text variable to be the complete Patron input
ASSIGN text = "{PatronEntries}"

ASSIGN proxy=GetRESTProxy()
//Utilize the URL provided by inContact for the Sentiment API
ASSIGN restURL="https://analytics.incontact.com/studio-gateway/annotate"
 
//These are the three steps to utilize sentiment based routing:
//1 - Authenticate against the API
//2 - Perform the annotation call to get sentiment details
//3 - Parse out custom logic from results for routing or other purposes.
 
//Step 1 - Authenticate against inContact API
ASSIGN TokenJsonInput = '{{"accessKeyId" : "GD3IPAXNYLVPHU6M4JK4TEV37A7DFJIWM2VZ7E2Q2SWTRZHL6MJQ====", "accessKeySecret" : "I7DUGDZEVMYKPO5FAD2QRQYHKZFXTBNVBB5PDN22CFADNLAN44MA===="}'
//Create URL for call
ASSIGN TokenRequestURL="https://na1.nice-incontact.com/authentication/v1/token/access-key"
//Create a Rest Proxy
ASSIGN proxy=GetRESTProxy()
proxy.ContentType="application/json"
//GetData
ASSIGN TokenResponse=proxy.MakeRestRequest(TokenRequestURL,TokenJsonInput,0,"POST")
//
IF(proxy.StatusCode != 200) 
	{
    GotToken = false
	StatusCode = proxy.StatusCode
	Description = proxy.StatusDescription
	
	}
ELSE
	{
	GotToken = true
	token = TokenResponse.access_token.$Value
	token_type = TokenResponse.token_type.$Value
	expires_in = TokenResponse.expires_in.$Value
	refresh_token = TokenResponse.refresh_token.$Value
	refresh_token_expires_in = TokenResponse.refresh_token_expires_in.$Value
	id_token = TokenResponse.id_token.$Value
	}
 
//Step 2 - Perform API Call to receive sentiment based results
//Create a new Proxy
ASSIGN proxy=GetRESTProxy()
//Utilize the URL provided by inContact for the Sentiment API
//ASSIGN restURL=""
proxy.ContentType="application/json"
//Utilize the token variable that came from the previous API call
proxy.AddHeader("Authorization","bearer {token}")
//In your params pass the text that should be utilized for review. In this example we used "where is my shipment?"
//ASSIGN params="{char(123)}{char(34)}text{char(34)}:{char(34)}Where is my shipment?{char(34)}{char(125)}"
//This next line is the same as the one above but shows an example utilizing a varaible for the text.
//You do not need both of these, just the one that fits your scripting need.
ASSIGN params="{char(123)}{char(34)}text{char(34)}:{char(34)}{text}{char(34)}{char(125)}"
//The response will include sentiment, language, categories amongst others.
//There is no need to change the parameters that are passed into this REST API call
ASSIGN result=proxy.MakeRestRequest(restURL, params, 0, "POST")

FUNCTION getSentimentColor(sentiment)
{
    color = ""
    IF sentiment = "POSITIVE"
    {
        color = "green"
    }
    IF sentiment = "NEGATIVE"
    {
        color = "red"
    }
    IF sentiment = "MIXED"
    {
        color = "orange"
    }
    
    IF sentiment = "NEUTRAL"
    {
        color = "orange"
    }
    RETURN color
}

//
//The sentiment, language, and categories variables below are pulled from the result.
ASSIGN sentiment=result.documentSentiment
ASSIGN language=result.language
ASSIGN categories=result.categories
ASSIGN entities = result.entities

ASSIGN sentColor = getSentimentColor("{sentiment}")

Analytics = ""
Analytics.append("Language: {language} &lt;br /&gt;")
Analytics.append("Sentiment: &lt;font color='{sentColor}'&gt;{Sentiment}&lt;/font&gt;&lt;br /&gt;")

categoryCount = count(categories)
IF categoryCount &gt; 0
{
    Analytics.append("Categories: &lt;ul&gt;")
    FOR i = 1 TO categoryCount
    {
        Analytics.append("&lt;li&gt;")
        
        categoryName = categories[i].categoryName
        confidence = categories[i].confidence
        path = categories[i].categoryPath
        Analytics.append("{categoryName} ({path} -- {confidence}%)&lt;br /&gt;")
        
        Analytics.append("&lt;/li&gt;")
    }
    Analytics.append("&lt;/ul&gt;")
}

Analytics.append("&lt;br /&gt;")


entityCount = count(entities)
IF entityCount &gt; 0
{
    Analytics.append("Entities:&lt;ul&gt;")
    FOR i = 1 TO entityCount
    {
        Analytics.append("&lt;li&gt;")
        
        entityText = entities[i].entityText
        entityType = entities[i].entityType
        entitySentiment = entities[i].entitySentiment
        
        
        ASSIGN sentColor = getSentimentColor("{entitySentiment}")
        Analytics.append("{entityText} ({entityType}) - &lt;font color='{sentColor}'&gt;{entitySentiment}&lt;/font&gt;")
        
        Analytics.append("&lt;/li&gt;")
    }
    Analytics.append("&lt;/ul&gt;")
}

doAnalytics = True</string>
        <string>Limit2K</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>74</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>448</X>
      <Y>752</Y>
      <DependencyOrder>45</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b333da63-33c8-4297-a58a-e9546cf7f0f2</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>74</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>94</ActionID>
      <Action>SNIPPET</Action>
      <Caption>Update CRM</Caption>
      <Parameters>
        <string />
        <string>Limit2K</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>224</X>
      <Y>1136</Y>
      <DependencyOrder>44</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b333da63-33c8-4297-a58a-e9546cf7f0f2</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>93</ActionID>
      <Action>REQAGENT</Action>
      <Caption>4136657 - AKR_Sales_IB_Email</Caption>
      <Parameters>
        <string>4136657</string>
        <string />
        <string>DefaultfromSkill</string>
        <string>0</string>
        <string>10</string>
        <string />
        <string>1000</string>
        <string />
        <string>AfterSequence</string>
        <string>Custom</string>
        <string />
        <string>1</string>
        <string>20</string>
        <string />
      </Parameters>
      <Branches />
      <Cases />
      <X>848</X>
      <Y>272</Y>
      <DependencyOrder>43</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>689a4a1b-fa0d-47b3-9a02-cbeb4735f08f</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>92</ActionID>
      <Action>HOURS</Action>
      <Caption>Hours</Caption>
      <Parameters>
        <string>167</string>
      </Parameters>
      <Branches>
        <BranchStruct>
          <Text>Open</Text>
          <ActionID>2</ActionID>
          <Index>0</Index>
          <Segments />
        </BranchStruct>
        <BranchStruct>
          <Text>Closed</Text>
          <ActionID>85</ActionID>
          <Index>1</Index>
          <Segments />
        </BranchStruct>
      </Branches>
      <Cases />
      <X>112</X>
      <Y>272</Y>
      <DependencyOrder>42</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>d639cf70-9de8-47fe-aa7e-6b39e4556d9d</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches>
          <BranchInfo>
            <KeyName>0</KeyName>
            <ActionId>2</ActionId>
            <Segments />
          </BranchInfo>
          <BranchInfo>
            <KeyName>1</KeyName>
            <ActionId>85</ActionId>
            <Segments />
          </BranchInfo>
        </Branches>
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>90</ActionID>
      <Action>SNIPPET</Action>
      <Caption>Create Email Body</Caption>
      <Parameters>
        <string>DYNAMIC akr_ivr_messages
ASSIGN initialmessage = "{akr_ivr_messages.my_message}"
 </string>
        <string>Limit2K</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>89</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>496</X>
      <Y>368</Y>
      <DependencyOrder>39</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b333da63-33c8-4297-a58a-e9546cf7f0f2</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>89</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>89</ActionID>
      <Action>ADDBODY</Action>
      <Caption>Addbody</Caption>
      <Parameters>
        <string>myEmail</string>
        <string>{initialmessage}</string>
        <string />
        <string>True</string>
        <string>ERRMSG</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>88</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>592</X>
      <Y>368</Y>
      <DependencyOrder>40</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>55ca29dc-4339-4142-8b8a-2086feabcd04</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>88</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>88</ActionID>
      <Action>SENDEMAIL</Action>
      <Caption>Sendemail</Caption>
      <Parameters>
        <string>myEmail</string>
        <string>False</string>
        <string>EMLFILE</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>93</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>688</X>
      <Y>368</Y>
      <DependencyOrder>39</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>71104c11-e0db-4d25-9035-0c24fd4dba5b</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>93</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>87</ActionID>
      <Action>ADDFROMADDR</Action>
      <Caption>Addfromaddr</Caption>
      <Parameters>
        <string>myEmail</string>
        <string>akrb32demo@mail.nice-incontact.com</string>
        <string>True</string>
        <string>ERRMSG</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>83</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>304</X>
      <Y>368</Y>
      <DependencyOrder>38</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>3ad2f70d-058d-447f-bdf9-5271a268b58e</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>83</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>86</ActionID>
      <Action>ADDTOADDR</Action>
      <Caption>Addtoaddr</Caption>
      <Parameters>
        <string>myEmail</string>
        <string>allon.rodin@niceincontact.com</string>
        <string>True</string>
        <string>ERRMSG</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>87</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>208</X>
      <Y>368</Y>
      <DependencyOrder>37</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>5d89cab8-cc23-4554-9e0f-307f2cef9ef9</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>87</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>85</ActionID>
      <Action>CREATEEMAIL</Action>
      <Caption>Createemail</Caption>
      <Parameters>
        <string>myEmail</string>
        <string>RE: this is my subject</string>
        <string>ContactID</string>
        <string />
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>86</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>112</X>
      <Y>368</Y>
      <DependencyOrder>36</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>fd05d941-8877-4710-8854-5b9266dfa9f4</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>86</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>83</ActionID>
      <Action>WORKFLOWDATA</Action>
      <Caption>Get Email Body from Workflow Data</Caption>
      <Parameters>
        <string>AKR_IVR_Messages</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>90</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>400</X>
      <Y>368</Y>
      <DependencyOrder>35</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>730aa8de-00a4-4ecc-ae0c-838d366bcae1</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>90</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>82</ActionID>
      <Action>IF</Action>
      <Caption>Send Survey?</Caption>
      <Parameters>
        <string>B1</string>
      </Parameters>
      <Branches>
        <BranchStruct>
          <Text>True</Text>
          <ActionID>81</ActionID>
          <Index>0</Index>
          <Segments />
        </BranchStruct>
        <BranchStruct>
          <Text>False</Text>
          <ActionID>94</ActionID>
          <Index>1</Index>
          <Segments />
        </BranchStruct>
      </Branches>
      <Cases />
      <X>128</X>
      <Y>1040</Y>
      <DependencyOrder>34</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>6695ba9c-e1d6-4f3c-a15a-94f1400e3169</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches>
          <BranchInfo>
            <KeyName>0</KeyName>
            <ActionId>81</ActionId>
            <Segments />
          </BranchInfo>
          <BranchInfo>
            <KeyName>1</KeyName>
            <ActionId>94</ActionId>
            <Segments />
          </BranchInfo>
        </Branches>
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>81</ActionID>
      <Action>ADDBODY</Action>
      <Caption>AddSurvey</Caption>
      <Parameters>
        <string>EML</string>
        <string />
        <string />
        <string>False</string>
        <string>ERRMSG</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>94</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>224</X>
      <Y>1040</Y>
      <DependencyOrder>33</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>55ca29dc-4339-4142-8b8a-2086feabcd04</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>94</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>80</ActionID>
      <Action>ONRELEASE</Action>
      <Caption>Onrelease</Caption>
      <Parameters>
        <string />
        <string />
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>82</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>32</X>
      <Y>1040</Y>
      <DependencyOrder>32</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>ea1363d4-fade-4cac-b15e-c4c514c2f9b5</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>82</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>79</ActionID>
      <Action>ANNOTATION</Action>
      <Caption>Annotation</Caption>
      <Parameters>
        <string>Assign Preferred Rep</string>
        <string>142</string>
        <string>35</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>704</Y>
      <DependencyOrder>31</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>d28d2b39-d4db-499a-9b8b-f3879e4c5b25</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>78</ActionID>
      <Action>REQAGENT</Action>
      <Caption>Alternate Rep</Caption>
      <Parameters>
        <string>Default</string>
        <string>{AlternateRep}</string>
        <string>DefaultfromSkill</string>
        <string>0</string>
        <string>1</string>
        <string />
        <string>1000</string>
        <string />
        <string>AfterSequence</string>
        <string>DefaultFromSkill</string>
        <string />
        <string>1</string>
        <string>20</string>
        <string />
      </Parameters>
      <Branches />
      <Cases />
      <X>912</X>
      <Y>752</Y>
      <DependencyOrder>30</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>689a4a1b-fa0d-47b3-9a02-cbeb4735f08f</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>77</ActionID>
      <Action>IF</Action>
      <Caption>If Preferred Available</Caption>
      <Parameters>
        <string>B1</string>
      </Parameters>
      <Branches>
        <BranchStruct>
          <Text>True</Text>
          <ActionID>75</ActionID>
          <Index>0</Index>
          <Segments />
        </BranchStruct>
        <BranchStruct>
          <Text>False</Text>
          <ActionID>78</ActionID>
          <Index>1</Index>
          <Segments />
        </BranchStruct>
      </Branches>
      <Cases />
      <X>768</X>
      <Y>752</Y>
      <DependencyOrder>29</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>6695ba9c-e1d6-4f3c-a15a-94f1400e3169</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches>
          <BranchInfo>
            <KeyName>0</KeyName>
            <ActionId>75</ActionId>
            <Segments />
          </BranchInfo>
          <BranchInfo>
            <KeyName>1</KeyName>
            <ActionId>78</ActionId>
            <Segments />
          </BranchInfo>
        </Branches>
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>76</ActionID>
      <Action>AGENTSTATE</Action>
      <Caption>Agentstate for Preferred Rep</Caption>
      <Parameters>
        <string>{PreferredRepID}</string>
        <string>STATE</string>
        <string>REASON</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>77</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>672</X>
      <Y>752</Y>
      <DependencyOrder>28</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>bf982147-891c-4ab5-a304-1a3c9c9b4d01</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>77</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>75</ActionID>
      <Action>REQAGENT</Action>
      <Caption>Preferred Rep</Caption>
      <Parameters>
        <string>Default</string>
        <string>{PreferredRep}</string>
        <string>DefaultfromSkill</string>
        <string>0</string>
        <string>1</string>
        <string />
        <string>1000</string>
        <string />
        <string>AfterSequence</string>
        <string>DefaultFromSkill</string>
        <string />
        <string>1</string>
        <string>20</string>
        <string />
      </Parameters>
      <Branches />
      <Cases />
      <X>912</X>
      <Y>672</Y>
      <DependencyOrder>27</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>689a4a1b-fa0d-47b3-9a02-cbeb4735f08f</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>74</ActionID>
      <Action>SNIPPET</Action>
      <Caption>Determine Preferred Reps</Caption>
      <Parameters>
        <string />
        <string>Limit2K</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>76</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>560</X>
      <Y>752</Y>
      <DependencyOrder>26</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b333da63-33c8-4297-a58a-e9546cf7f0f2</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>76</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>73</ActionID>
      <Action>SNIPPET</Action>
      <Caption>Customer Lookup</Caption>
      <Parameters>
        <string />
        <string>Limit2K</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>95</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>752</Y>
      <DependencyOrder>25</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b333da63-33c8-4297-a58a-e9546cf7f0f2</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>95</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>72</ActionID>
      <Action>CCARDCREATE</Action>
      <Caption>CCCreate</Caption>
      <Parameters>
        <string />
        <string />
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>23</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>416</X>
      <Y>272</Y>
      <DependencyOrder>24</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>889cda0d-5ee8-49b4-be52-7bb176ac01ed</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>23</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>71</ActionID>
      <Action>INDICATE</Action>
      <Caption>Indicate_CXoneExpert</Caption>
      <Parameters>
        <string>Agents</string>
        <string>{__AgentID}</string>
        <string>LaunchCXoneExpert</string>
        <string>https://icons.incontact.com/incontact/images/indicator/computer.png</string>
        <string>Launch CXone Expert (AKR)</string>
        <string>On</string>
        <string>OpenURL</string>
        <string>https://cxonese-demo.mindtouch.us/Sales_Engineers/Allon_Rodin/Expert/?mt-view=f1</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>224</X>
      <Y>912</Y>
      <DependencyOrder>23</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>28bc752b-456c-4931-8506-ac24863761fa</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>70</ActionID>
      <Action>CASE</Action>
      <Caption>Check for Special Words</Caption>
      <Parameters>
        <string>B1</string>
      </Parameters>
      <Branches />
      <Cases>
        <BranchStruct>
          <Text>Special Words Detected</Text>
          <ActionID>68</ActionID>
          <Index>0</Index>
          <Segments />
        </BranchStruct>
        <BranchStruct>
          <Text>No Special Words</Text>
          <ActionID>69</ActionID>
          <Index>0</Index>
          <Segments />
        </BranchStruct>
      </Cases>
      <X>448</X>
      <Y>624</Y>
      <DependencyOrder>22</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>22050500-6dc0-4949-af9c-1e52975f141d</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches>
          <BranchInfo>
            <KeyName>Special Words Detected</KeyName>
            <ActionId>68</ActionId>
            <Segments />
          </BranchInfo>
          <BranchInfo>
            <KeyName>No Special Words</KeyName>
            <ActionId>69</ActionId>
            <Segments />
          </BranchInfo>
        </CaseBranches>
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>69</ActionID>
      <Action>REQAGENT</Action>
      <Caption>Standard Skill</Caption>
      <Parameters>
        <string>Default</string>
        <string />
        <string>DefaultfromSkill</string>
        <string>0</string>
        <string>1</string>
        <string />
        <string>1000</string>
        <string />
        <string>AfterSequence</string>
        <string>DefaultFromSkill</string>
        <string />
        <string>1</string>
        <string>20</string>
        <string />
      </Parameters>
      <Branches />
      <Cases />
      <X>720</X>
      <Y>544</Y>
      <DependencyOrder>21</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>689a4a1b-fa0d-47b3-9a02-cbeb4735f08f</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>68</ActionID>
      <Action>REQAGENT</Action>
      <Caption>Special Words Skill</Caption>
      <Parameters>
        <string>Default</string>
        <string />
        <string>DefaultfromSkill</string>
        <string>0</string>
        <string>1</string>
        <string />
        <string>1000</string>
        <string />
        <string>AfterSequence</string>
        <string>DefaultFromSkill</string>
        <string />
        <string>1</string>
        <string>20</string>
        <string />
      </Parameters>
      <Branches />
      <Cases />
      <X>720</X>
      <Y>624</Y>
      <DependencyOrder>20</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>689a4a1b-fa0d-47b3-9a02-cbeb4735f08f</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>67</ActionID>
      <Action>REQAGENT</Action>
      <Caption>French Skill</Caption>
      <Parameters>
        <string>Default</string>
        <string />
        <string>DefaultfromSkill</string>
        <string>0</string>
        <string>1</string>
        <string />
        <string>1000</string>
        <string />
        <string>AfterSequence</string>
        <string>DefaultFromSkill</string>
        <string />
        <string>1</string>
        <string>20</string>
        <string />
      </Parameters>
      <Branches />
      <Cases />
      <X>720</X>
      <Y>160</Y>
      <DependencyOrder>19</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>689a4a1b-fa0d-47b3-9a02-cbeb4735f08f</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>66</ActionID>
      <Action>REQAGENT</Action>
      <Caption>Spanish Skill</Caption>
      <Parameters>
        <string>Default</string>
        <string />
        <string>DefaultfromSkill</string>
        <string>0</string>
        <string>1</string>
        <string />
        <string>1000</string>
        <string />
        <string>AfterSequence</string>
        <string>DefaultFromSkill</string>
        <string />
        <string>1</string>
        <string>20</string>
        <string />
      </Parameters>
      <Branches />
      <Cases />
      <X>720</X>
      <Y>80</Y>
      <DependencyOrder>18</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>689a4a1b-fa0d-47b3-9a02-cbeb4735f08f</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>65</ActionID>
      <Action>ANNOTATION</Action>
      <Caption>Annotation</Caption>
      <Parameters>
        <string>Auto Reply</string>
        <string>142</string>
        <string>35</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>464</Y>
      <DependencyOrder>17</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>d28d2b39-d4db-499a-9b8b-f3879e4c5b25</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>64</ActionID>
      <Action>REPLY</Action>
      <Caption>Reply</Caption>
      <Parameters>
        <string>{AutoReplyMessage}</string>
        <string>True</string>
        <string />
      </Parameters>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>512</Y>
      <DependencyOrder>16</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>6e8d426f-01af-4bdb-b4ae-4297e920a148</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>62</ActionID>
      <Action>ANNOTATION</Action>
      <Caption>Annotation</Caption>
      <Parameters>
        <string>Word detection</string>
        <string>142</string>
        <string>35</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>576</Y>
      <DependencyOrder>15</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>d28d2b39-d4db-499a-9b8b-f3879e4c5b25</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>61</ActionID>
      <Action>MESSAGES</Action>
      <Caption>Messages</Caption>
      <Parameters>
        <string>Agent</string>
        <string>{AgentID}</string>
        <string>ATTENTION:  The last agent to respond to an email from this customer was Mark Ligi</string>
        <string>0</string>
        <string>False</string>
        <string />
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>71</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>128</X>
      <Y>912</Y>
      <DependencyOrder>14</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>4266fb7b-7c7a-4b23-9ee8-02c2fa2a2341</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>71</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>59</ActionID>
      <Action>ANNOTATION</Action>
      <Caption>Annotation</Caption>
      <Parameters>
        <string>Language translation</string>
        <string>130</string>
        <string>32</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>0</Y>
      <DependencyOrder>13</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>d28d2b39-d4db-499a-9b8b-f3879e4c5b25</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>58</ActionID>
      <Action>ANNOTATION</Action>
      <Caption>Annotation</Caption>
      <Parameters>
        <string>Language detection</string>
        <string>142</string>
        <string>32</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>128</Y>
      <DependencyOrder>12</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>d28d2b39-d4db-499a-9b8b-f3879e4c5b25</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>57</ActionID>
      <Action>ANNOTATION</Action>
      <Caption>Annotation</Caption>
      <Parameters>
        <string>Email agent experience to be built out here</string>
        <string>270</string>
        <string>32</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>32</X>
      <Y>864</Y>
      <DependencyOrder>11</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>d28d2b39-d4db-499a-9b8b-f3879e4c5b25</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>56</ActionID>
      <Action>ANNOTATION</Action>
      <Caption>Annotation</Caption>
      <Parameters>
        <string>Email IVR journey to be built out here</string>
        <string>270</string>
        <string>32</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>16</X>
      <Y>224</Y>
      <DependencyOrder>10</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>d28d2b39-d4db-499a-9b8b-f3879e4c5b25</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>54</ActionID>
      <Action>ONANSWER</Action>
      <Caption>Onanswer</Caption>
      <Parameters>
        <string>SKLNAME</string>
        <string>FIRST</string>
        <string>LAST</string>
        <string>AGENTID</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>61</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>32</X>
      <Y>912</Y>
      <DependencyOrder>9</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>4b611ba4-8e81-45a6-9fcc-97c24f43ccbc</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>61</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>46</ActionID>
      <Action>SNIPPET</Action>
      <Caption>Language Translation</Caption>
      <Parameters>
        <string>IF Test
{
//ASSIGN EBODY = "The quick brown fox jumps over the lazy dog." //English
ASSIGN EBODY = "Ogni individuo ha diritto all'istruzione. L'istruzione deve essere gratuita almeno per quanto riguarda le classi elementari e fondamentali." //Italian
//ASSIGN EBODY = "Jetzt hieß das kleine schwarze Kätzchen Tinte, Und die kleine graue Maus, die sie Blink nannte, Und der kleine gelbe Hund war scharf wie Senf, Aber der Drache war ein Feigling, und sie nannte ihn Custard."  //German
//ASSIGN EBODY = "Nous tenons ces vérités pour aller de soi, que tous les hommes sont créés égaux, qu'ils sont dotés par leur Créateur de certains droits inaliénables."  //French
//ASSIGN EBODY = "Выздоровев от травмы, Джим ищет место на «Патне», пароходе, который перевозит 800 «паломников строгой веры» в порт на Красном море. Его нанимают первым помощником капитана. После нескольких дней плавного плавания корабль ночью сталкивается с чем-то и начинает набирать воду."  //Russian
}

// Setup a Proxy for the request for NiC instance
ASSIGN restURL		= "https://api.us-south.language-translator.watson.cloud.ibm.com/instances/b549ba01-3102-41a3-9fce-643d18faee6d/v3/identify"
//Set the endpoint to perform language tranlation
ASSIGN restURL1		= "https://api.us-south.language-translator.watson.cloud.ibm.com/instances/b549ba01-3102-41a3-9fce-643d18faee6d/v3/translate"
ASSIGN version		= "2018-05-01" 
ASSIGN n_version	= version.urlencode()
params		= "?"
params.append("version={n_version}")
queryURL = "{restURL}{params}"			
queryURL1 = "{restURL1}{params}"
//set up tempproxy as a temp REST proxy to base64 encode the API key
ASSIGN tempproxy = GetRESTProxy()
//SET UP AUTHORIZATION
ASSIGN APIKEY = "j-C46gGOMkwtz70yZa06wbtWXtlxU-26BEmKQtUvFfMl"
ASSIGN tempAuth = "apikey:{APIKEY}"
// Base 64 encode api key
ASSIGN restAuth = tempproxy.EncodeBase64(tempAuth)
ASSIGN auth = "Basic {restAuth}"	

//set up REST proxy
ASSIGN proxy = GetRESTProxy()
proxy.AddHeader("Authorization", "{auth}")
proxy.ContentType = "text/plain"

//specify the payload to send (i.e., email body text)
DYNAMIC payload
ASSIGN payload.body = "{EBODY}"
ASSIGN payloadJson = "{payload.asjson()}"

//make proxy request
ASSIGN result = proxy.MakeRestRequest(queryURL, payloadJson, 0, "POST")

//identify language
ASSIGN Z_Language = result.languages[1].language.$value

//set up REST proxy
ASSIGN proxy1 = GetRESTProxy()
proxy1.AddHeader("Authorization", "{auth}")
proxy1.ContentType = "application/json"

//specify the payload to send (i.e., email body text)
DYNAMIC payload1
ASSIGN payload1.text = "{EBODY}"
ASSIGN payload1.source = "{Z_Language}"
ASSIGN payload1.target = "en"
ASSIGN payload1Json = "{payload1.asjson()}"

//make proxy request
ASSIGN result1 = proxy1.MakeRestRequest(queryURL1, payload1Json, 0, "POST")

//capture transcript
ASSIGN Z_Translation = result1.translations[1].translation.$value
ASSIGN Z_WordCount = result1.word_count.$value
ASSIGN Z_CharCount = result1.character_count.$value

</string>
        <string>Limit2K</string>
      </Parameters>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>32</Y>
      <DependencyOrder>8</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b333da63-33c8-4297-a58a-e9546cf7f0f2</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>44</ActionID>
      <Action>SNIPPET</Action>
      <Caption>Search for word</Caption>
      <Parameters>
        <string>IF TEST = 1
{
ASSIGN BODY = "I want to let you know that I left a BOM in my room"
}

ASSIGN bombfound = BODY.contains('bomb')
</string>
        <string>Limit2K</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>70</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>624</Y>
      <DependencyOrder>7</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b333da63-33c8-4297-a58a-e9546cf7f0f2</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>70</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>43</ActionID>
      <Action>CASE</Action>
      <Caption>Route based on language</Caption>
      <Parameters>
        <string>Language</string>
      </Parameters>
      <Branches />
      <Cases>
        <BranchStruct>
          <Text>French</Text>
          <ActionID>67</ActionID>
          <Index>0</Index>
          <Segments />
        </BranchStruct>
        <BranchStruct>
          <Text>Spanish</Text>
          <ActionID>66</ActionID>
          <Index>0</Index>
          <Segments />
        </BranchStruct>
      </Cases>
      <X>448</X>
      <Y>160</Y>
      <DependencyOrder>6</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>22050500-6dc0-4949-af9c-1e52975f141d</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>-1</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches>
          <BranchInfo>
            <KeyName>French</KeyName>
            <ActionId>67</ActionId>
            <Segments />
          </BranchInfo>
          <BranchInfo>
            <KeyName>Spanish</KeyName>
            <ActionId>66</ActionId>
            <Segments />
          </BranchInfo>
        </CaseBranches>
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>42</ActionID>
      <Action>SNIPPET</Action>
      <Caption>Language Detection</Caption>
      <Parameters>
        <string>IF Test
{
//ASSIGN EBODY = "The quick brown fox jumps over the lazy dog." //English
//ASSIGN EBODY = "La rapida volpe marrone salta sopra il cane pigro." //Italian
//ASSIGN EBODY = "Der schnelle Braunfuchs springt über den faulen Hund."  //German
//ASSIGN EBODY = "敏捷的棕色狐狸跳过了懒狗"  //Mandarin
//ASSIGN EBODY = "빠른 갈색 여우가 게으른 개를 뛰어 넘습니다."  //Korean
ASSIGN EBODY = "速い茶色のキツネは怠惰な犬を飛び越えます"  //Japanese
//ASSIGN EBODY = "الثعلب البني السريع يقفز فوق الكلب الكسول"  //Arabic
}

ASSIGN restURL		= "https://api.us-south.language-translator.watson.cloud.ibm.com/instances/b549ba01-3102-41a3-9fce-643d18faee6d/v3/identify"
ASSIGN version		= "2018-05-01" 
ASSIGN n_version	= version.urlencode()
params				= "?"
params.append("version={n_version}")
queryURL = "{restURL}{params}"

//set up tempproxy as a temp REST proxy to base64 encode the API key
ASSIGN tempproxy = GetRESTProxy()
//SET UP AUTHORIZATION
ASSIGN APIKEY = "j-C46gGOMkwtz70yZa06wbtWXtlxU-26BEmKQtUvFfMl"
ASSIGN tempAuth = "apikey:{APIKEY}"
// Base 64 encode api key
ASSIGN restAuth = tempproxy.EncodeBase64(tempAuth)
ASSIGN auth = "Basic {restAuth}"

//set up REST proxy
ASSIGN proxy = GetRESTProxy()
proxy.AddHeader("Authorization", "{auth}")
proxy.AddHeader("X-Watson-Learning-Opt-Out", "true")
proxy.ContentType = "text/plain"


//specify the payload to send (i.e., email body text)
DYNAMIC payload
ASSIGN payload.body = "{EBODY}"
ASSIGN payload.cache_mode = "ro"
ASSIGN payloadJson = "{payload.asjson()}"


//make proxy request
ASSIGN result = proxy.MakeRestRequest(queryURL, payloadJson, 0, "POST")

//identify language
ASSIGN Z_Language = result.languages[1].language.$value
ASSIGN Z_Confidence = result.languages[1].confidence.$value

IF Z_Confidence &gt;= .38
{
	SWITCH Z_Language 
	{
		CASE "ar"
			{
			ASSIGN Language = "Arabic"
			}
		CASE "zh"
			{
			ASSIGN Language = "Chinese"
			}
		CASE "zh-TW"
			{
			ASSIGN Language = "Chinese"
			}
		CASE "cs"
			{
			ASSIGN Language = "Czech"
			}
		CASE "da"
			{
			ASSIGN Language = "Danish"
			}
		CASE "en"
			{
			ASSIGN Language = "English"
			}
		CASE "fi"
			{
			ASSIGN Language = "Finnish"
			}
		CASE "fr"
			{
			ASSIGN Language = "French"
			}
		CASE "de"
			{
			ASSIGN Language = "German"
			}
		CASE "el"
			{
			ASSIGN Language = "Greek"
			}
		CASE "hi"
			{
			ASSIGN Language = "Hindi"
			}
		CASE "hu"
			{	
			ASSIGN Language = "Hungarian"
			}
		CASE "it"
			{
			ASSIGN Language = "Italian"
			}
		CASE "ja"
			{
			ASSIGN Language = "Japanese"
			}
		CASE "ko"
			{
			ASSIGN Language = "Korean"
			}
		CASE "nb"
			{
			ASSIGN Language = "Norwegian"
			}
		CASE "fa"
			{
			ASSIGN Language = "Persian"
			}
		CASE "pl"
			{
			ASSIGN Language = "Polish"
			}
		CASE "pt"
			{
			ASSIGN Language = "Portuguese"
			}
		CASE "ru"
			{
			ASSIGN Language = "Russian"
			}
		CASE "sv"
			{
			ASSIGN Language = "Swedish"
			}
		CASE "tr"
			{
			ASSIGN Language = "Turkish"
			}
		CASE "uk"
			{
			ASSIGN Language = "Ukrainian"
			}
		CASE "ur"
			{
			ASSIGN Language = "Urdu"
			}
		CASE "vi"
			{
			ASSIGN Language = "Vietnamese"
			}	
	}
}
ELSE
{
	ASSIGN Language = "Unknown"
}</string>
        <string>Limit2K</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>43</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>336</X>
      <Y>160</Y>
      <DependencyOrder>5</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b333da63-33c8-4297-a58a-e9546cf7f0f2</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>43</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>41</ActionID>
      <Action>SETLABEL</Action>
      <Caption>Setlabel</Caption>
      <Parameters>
        <string>Caller</string>
        <string>{__label}</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>93</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>704</X>
      <Y>272</Y>
      <DependencyOrder>4</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>656e1d78-a653-4fdb-8d82-aa59d451ab11</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>93</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>23</ActionID>
      <Action>SNIPPET</Action>
      <Caption>Set variables</Caption>
      <Parameters>
        <string>
 __label="John Coffey"</string>
        <string>Limit2K</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>41</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>560</X>
      <Y>272</Y>
      <DependencyOrder>3</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b333da63-33c8-4297-a58a-e9546cf7f0f2</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>41</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>18</ActionID>
      <Action>LOGEMAIL</Action>
      <Caption>Log Email</Caption>
      <Parameters>
        <string>True</string>
        <string>30</string>
        <string>True</string>
        <string>30</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>72</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>320</X>
      <Y>272</Y>
      <DependencyOrder>2</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>4176a279-a08b-42c0-bdf4-79ff93ba87db</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>72</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>2</ActionID>
      <Action>GETEMAIL</Action>
      <Caption>Set Email Variables</Caption>
      <Parameters>
        <string>EML</string>
        <string>eSubject</string>
        <string>EFROM</string>
        <string>ETO</string>
        <string>ECC</string>
        <string>EDATE</string>
        <string>EBODY</string>
        <string>AttachList</string>
        <string>Limit2K</string>
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>18</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>240</X>
      <Y>272</Y>
      <DependencyOrder>1</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>e5db2745-2425-4aa2-bd90-97b0ef440c12</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>18</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
    <ActionStruct>
      <ActionID>1</ActionID>
      <Action>BEGIN</Action>
      <Caption>Begin</Caption>
      <Parameters>
        <string />
        <string />
        <string />
      </Parameters>
      <DefaultNextAction>
        <Text />
        <ActionID>92</ActionID>
        <Index>0</Index>
        <Segments />
      </DefaultNextAction>
      <Branches />
      <Cases />
      <X>16</X>
      <Y>272</Y>
      <DependencyOrder>0</DependencyOrder>
      <Impl_Type>0</Impl_Type>
      <LibraryID>b2f794c5-0232-40e7-9830-76d573bf57d7</LibraryID>
      <ExtraInfo>
        <DefaultBranch>
          <ActionId>92</ActionId>
          <Segments />
        </DefaultBranch>
        <Branches />
        <CaseBranches />
      </ExtraInfo>
      <xws>0</xws>
      <yws>0</yws>
    </ActionStruct>
  </Actions>
  <LibraryItem LibraryID="5905b016-28aa-4350-802e-8f39a3fec763" ApiClassificationId="0" BusNo="4597359" Name="AKR_IB_Email" Alias="AKR_IB_Email" MediaType="1" RouteOrder="1000" RoutingMode="" VariableRedaction="">
    <Icon>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABVTeXN0ZW0uRHJhd2luZy5CaXRtYXABAAAABERhdGEHAgIAAAAJAwAAAA8DAAAAiwUAAAKJUE5HDQoaCgAAAA1JSERSAAAAIAAAACAIAgAAAPwY7aMAAAABc1JHQgCuzhzpAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAABSBJREFUSEutVllsG1UUfZ9pm7ZRlSqL4yW2E8dZbCexkzqJ4ziOd3vs8b6vYxNKS9JSGqChhVSARJBQEZtYK0ACyhoKlCJElCKhQlk+4KNICAkiJCpaqcAHiK2cYSwnclMzH1jXo/ve3HfP3d+QK//+Ll68fPz4yZmZRYZZyOfvyOUOZzLzqdShROLWWGwuGr05HL4pGNzn98/6fHu93j0ez26Xa9rpLNlsjNWan5rKTk5mTKaU0ZgwGGKjoxGa3r2y8hE0E/xXVy+EQgfb2z1NTZb/i8Rih1ZLLy+fJbAd2vnrHbyetr8Ql4+7Os0uicZR46BIZHe5GILI8LRdrLIP7fMnvsmVrpQyPxbw7C/4alvW3+8hs7OLPM3X5H1QWqH8L4z50UiX3V3juFrtIsXiUZ4Auhl/6e9S9lKhn/FBdfGPIsCod5MCqe1aGlQqB2GYO/kAtHXYgucy0Jj8Ni/ssg0f8DO/FVPf5zU5b43jvb12ks8f4QMAM8fuCiVX88AIfZbhGN9yCokRq+3Q0OV090WpVol1vbbubivJZg/zAYCMdMgR+4rNMEdwyPFifPRI0HhfuJvyTD4c8byZ6AlQ67UplVMknZ7nCQAx7V5af1vA/nwMANJhp0BqtTwdhV7nK3HXUsJxIj5ye2BwmlbYyplXKCYJ2pU/QEsbGwFRtx0FKhlknzAcfjhfZQn9AaJXUlOPRVvbWcnOThPBMOAPUJEUyGyGu0PUqaTt2RgMHz7oV6e9KC0AOF6KA7i5lR0KcrmRxONzVwP00B7YlfuJ4cINBktsViRbhNZdtwRsz8UQGdODkbZOtlJVMcp9MoEdVdzLeSCVGggG2XoAiPo/TOcuM563k6YHwuOLIRAYLLGJV5wuEFtXC0EU0uRDkXado0VkhR9srF6Ou15P9AbZbEskYyQcPlABwOHIl9nQJ5mJY2HqdDL+dS79QwEEBkts4hUEWIxmC4qSDciJOPwAxvi9IYTL+kxs6omo6VhYqGDtEItHSCi0vwIAA6ECEsnv8pYno1yvcgQ+c6GAVxCAGAB6wxTihiqyPBUFkve9pOu1BBhNdq31hEI9CQRmOQCEGEGAmdCOOaM/FCj+VaoiTgBPCDcLrOgMucEJAMQETqB8Q59mlK616dTWNkz8/hkOACWBQCMU2UtM8c+S+ZEo/UEaTBUFzqZZsVPJit9jR4OoHNmIE808tN/PpZej1lYdwQ3FLVAqSCbCXfi1yPxeDH+e0e6hwXAE0xANMPmfWTEIr88cmo5bctVZoebmQUJRN3BrBBoFg5RiinEkGXAAD9NNPx8w3BOq7EMMwvy6p5/gdq0CQIg4GriO7otQSrdndCFY2QTDH2DnTg3B3V0Vouj5HEdTj0cxG4bnApUdMJEvslUhquFKY6OK4MugKsmYxsjktcj9RqIqyTUAduzoI3Z7OV2VMo2dz/neT21IuL+M95fLlE8OGhp6iNVauLrRMOtRr1XkeavczGyj8fvA2b5dSSyW3IajAr1DvVPGAI/GRm7XRgU/gK1bu4jZnF1vDv9hx8eJ+vpOYjJt4O9/jms+2iGzebOcTEysNT3PY/zF6uqkmKY3SiTlRud/ko9kY6NBLh8jZ86c0+vD+Fblc4a/DLTX1cmWlk6zX9crKx97vdM6Ha3V+gYGKI3GrVY78c3U02NVKi0KhRl3t0xmxP0nkYyKRHqhcJdAoGtp0TY1DWAYoF3RUA0N3du2KevrFVu2dGzaJOvoGIN2KP8HVQ1aCsWAeQgAAAAASUVORK5CYIIL</Icon>
    <ImplPath>AllonRodin\AKR_IB_Email</ImplPath>
    <CreateDate>2021-05-24T22:20:00.53</CreateDate>
    <ModifyDate>2022-08-16T22:45:30.56</ModifyDate>
    <ModifyUserID>7141209</ModifyUserID>
    <ModifiedBy>Allon Rodin</ModifiedBy>
    <URI>/custom/4596619/OAT_IB_EMAIL</URI>
    <DefaultTimeZone>Mountain Standard Time</DefaultTimeZone>
    <Parameters />
    <Branches />
  </LibraryItem>
  <MediaType>1</MediaType>
  <ModifyDate>0001-01-01T00:00:00</ModifyDate>
</ScriptContainer>